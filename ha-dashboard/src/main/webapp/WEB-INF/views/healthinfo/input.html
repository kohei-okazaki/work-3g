<!DOCTYPE html>
<html lang="ja"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head th:replace="layout/layout :: head_fragment(title = '健康アプリ_健康情報入力画面', scripts = ~{::script}, links = ~{::link})">
<link rel="stylesheet" type="text/css" href="../resources/css/navigation.css" th:href="@{/resources/css/navigation.min.css}">
<link rel="stylesheet" type="text/css" href="../resources/css/lib/mprogress.css" th:href="@{/resources/css/lib/mprogress.min.css}">
<link rel="stylesheet" type="text/css" href="../resources/css/lib/sal.css" th:href="@{/resources/css/lib/sal.min.css}">
</head>
<body>

  <!--/* ヘッダ部 */-->
  <div th:replace="layout/layout :: header"></div>

  <!--/* メニュー部 */-->
  <div th:replace="./common/navigation.html"></div>

  <div layout:fragment="contents">

    <div th:if="${errorMessage} != null">
      <br><br>
      <div class="errorMessage">
        <p th:text="${errorMessage}"></p>
      </div>
    </div>

    <!--/* contentLayout部ここから */-->
    <div align="center" class="contentLayout">
      <h2 class="menuTitle">健康情報入力画面</h2>

      <form action="./confirm" id="healthInfoForm" th:action="@{./confirm}" method="post" th:object="${healthInfoForm}">

        <div class="errorMessage" th:if="${#fields.hasErrors('height')}" th:errors="*{height}" data-sal="slide-up"></div>
        <div class="errorMessage" th:if="${#fields.hasErrors('weight')}" th:errors="*{weight}" data-sal="slide-up"></div>

        <!--/* table部ここから */-->
        <div class="table">
          <h3 id="healthInfoToggle">健康情報</h3>

          <div class="table-row healthInfoToggle">
            <div class="table-header" th:text="#{height}"></div>
            <div class="table-data">
              <input type="text" class="validate[required,custom[number]]" size="12" th:field="*{height}" required placeholder="170.00" />&ensp;cm
            </div>
            <div class="table-data">
              <p class="attention">※半角数字とピリオドで入力してください</p>
            </div>
          </div>

          <div class="table-row healthInfoToggle">
            <div class="table-header" th:text="#{weight}"></div>
            <div class="table-data">
              <input type="text" class="validate[required,custom[number]]" size="12" th:field="*{weight}" required placeholder="50.00" />&ensp;kg
            </div>
            <div class="table-data">
              <p class="attention">※半角数字とピリオドで入力してください</p>
            </div>
          </div>
        </div>
        <!--/* table部ここまで */-->

        <br><br>

        <!--/* table部ここから */-->
        <div class="table">
          <div class="table-row">
            <div class="table-data">
              <input type="submit" value="確 認" />
            </div>
            <div class="table-data">&ensp;&ensp;</div>
            <div class="table-data">
              <input type="reset" value="リセット" />
            </div>
          </div>
        </div>
        <!--/* table部ここまで */-->

      </form>
    </div>
    <!--/* contentLayout部ここまで */-->

  </div>

  <!--/* フッタ部 */-->
  <div th:replace="layout/layout :: footer"></div>

  <script type="text/javascript" src="../resources/js/lib/jquery.validationEngine-ja.js" th:src="@{/resources/js/lib/jquery.validationEngine-ja.min.js}"></script>
  <script type="text/javascript" src="../resources/js/lib/jquery.validationEngine.js" th:src="@{/resources/js/lib/jquery.validationEngine.min.js}"></script>
  <script type="text/javascript" src="../resources/js/lib/mprogress.js" th:src="@{/resources/js/lib/mprogress.min.js}"></script>
  <script type="text/javascript" src="../resources/js/lib/sal.js" th:src="@{/resources/js/lib/sal.min.js}"></script>
  <script type="text/javascript">
    $(function() {

      sal({
        threshold: 1,
        once: false
      });

      jQuery("#healthInfoForm").validationEngine({
        promptPosition : "topLeft:0"
      });

      let dispOffTime = 400;
      // 健康情報のトグルを設定
      $("#healthInfoToggle").css({
        "cursor": "pointer"
      });
      $("#healthInfoToggle").on("click", function() {
          $(".healthInfoToggle").toggle(dispOffTime);
      });

      var mprogress = new Mprogress();
      $("#height").on("change", function() {
        var value = 0;
        if ($('#height').val() !== '') {
          value += 1;
        }
        if ($('#weight').val() !== '') {
          value += 1;
        }
        var progressValue = value / 2;
        mprogress.set(progressValue);
      });

      $("#weight").on("change", function() {
        var value = 0;
        if ($('#height').val() !== '') {
          value += 1;
        }
        if ($('#weight').val() !== '') {
          value += 1;
        }
        var progressValue = value / 2;
        mprogress.set(progressValue);
      });

    });

  </script>
</body>
</html>
